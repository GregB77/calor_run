<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stats Calor Run</title>
<style>
:root {
  --bg:#f9f9f9; --fg:#111; --card:#fff; --line:#e5e5e5;
  --head-blue: #215E99;
  --head-pink: #E61780;
  --head-gray: #999;
}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--fg);line-height:1.5;padding:24px;transition:background 0.3s,color 0.3s;}
body.dark { background:#121212; color:#eee; }
body.dark .card { background:#1e1e1e; color:#eee; border-color:#333; }
body.dark th { color:#fff; }
body.dark tbody tr:nth-child(odd) { background:#1e1e1e; }
body.dark tbody tr:nth-child(even) { background:#2a2a2a; }

h1{font-size:2rem;margin-bottom:8px;color:#215E99;}
.wrap{display:grid;gap:20px;}
.card{background:var(--card);border:1px solid var(--line);border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.06);padding:16px;}
.card h2{font-size:1.1rem;margin-bottom:12px;}
.tables{overflow-x:auto;}
table{width:100%;border-collapse:collapse;min-width:640px;}
th,td{border:1px solid var(--line);padding:6px 8px;text-align:center;font-size:.95rem;}
tbody tr:nth-child(odd){background:#fff;}
tbody tr:nth-child(even){background:#f2f2f2;}
.muted{color:#777;}

/* Grille 1 - couleurs spécifiques des colonnes */
#tbl-cat th:nth-child(2),
#tbl-cat th:nth-child(3),
#tbl-cat th:nth-child(4) { background: var(--head-blue); }
#tbl-cat th:nth-child(5),
#tbl-cat th:nth-child(6),
#tbl-cat th:nth-child(7) { background: var(--head-pink); }
#tbl-cat th:nth-child(1),
#tbl-cat th:nth-child(8) { background: var(--head-gray); }

/* Grille 2 - couleurs des en-têtes */
#tbl-age-10 th { background: var(--head-blue); color: #fff; }
#tbl-age-20 th { background: var(--head-pink); color: #fff; }

/* séparations verticales discrètes */
th.sep, td.sep { border-left:1px solid #ccc; }

/* colonnes Totaux en gras */
th.total, td.total { font-weight:700; }

/* Ligne bascule thème et dernière mise à jour */
.footer { text-align:center; margin-top:20px; font-size:0.9rem; color:#666; }
.footer a { color: var(--head-blue); text-decoration:none; margin-left:6px; }
</style>
</head>
<body>

<div class="wrap">

<section class="card">
<h2>Répartition par catégories</h2>
<div class="tables">
  <table id="tbl-cat">
    <thead>
      <tr>
        <th>Catégorie</th>
        <th class="sep">Femmes (10km)</th>
        <th>Hommes (10km)</th>
        <th class="total">Total (10km)</th>
        <th class="sep">Femmes (20km)</th>
        <th>Hommes (20km)</th>
        <th class="total">Total (20km)</th>
        <th class="sep total">Total général</th>
      </tr>
    </thead>
    <tbody><tr><td colspan="8" class="muted">Chargement…</td></tr></tbody>
  </table>
</div>
</section>

<section class="card">
  <h2>-/+ Âgés - 10 km | 20 km</h2>
  <div class="tables" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
    
    <table id="tbl-age-10">
      <thead>
        <tr>
          <th>Dossard</th>
          <th>Prénom</th>
          <th>Nom</th>
          <th>Âge</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="4" class="muted">Chargement…</td></tr>
      </tbody>
    </table>

    <table id="tbl-age-20">
      <thead>
        <tr>
          <th>Dossard</th>
          <th>Prénom</th>
          <th>Nom</th>
          <th>Âge</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="4" class="muted">Chargement…</td></tr>
      </tbody>
    </table>

  </div>
</section>

<div id="err" class="error" style="display:none;"></div>

</div>

<!-- Footer bascule thème et dernière mise à jour -->
<div class="footer">
  Dernière mise à jour : <span id="update-time">--:--:--</span>
  · <a href="#" id="theme-toggle">Basculer le thème</a>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
// Firebase init et fonctions de rendu comme précédemment
const firebaseConfig = {
  apiKey:"AIzaSyAIAAz51gEGKQd0EoqA3yUhvnqw3DkQiIo",
  authDomain:"calor-run.firebaseapp.com",
  databaseURL:"https://calor-run-default-rtdb.europe-west1.firebasedatabase.app",
  projectId:"calor-run",
  storageBucket:"calor-run.firebasestorage.app",
  messagingSenderId:"329949291334",
  appId:"1:329949291334:web:c71ef20268c609cf953b47"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const el = {
  cat: document.querySelector('#tbl-cat tbody'),
  age10: document.querySelector('#tbl-age-10 tbody'),
  age20: document.querySelector('#tbl-age-20 tbody'),
  err: document.getElementById('err'),
  updateTime: document.getElementById('update-time'),
  themeToggle: document.getElementById('theme-toggle')
};

// Fonctions parseDate, computeAge, renderCats, renderAges, showError identiques à ton code précédent

// Exemple simplifié pour mise à jour de la dernière date
db.ref('participants').on('value', snap => {
  const data = snap.val() || {};
  renderCats(el.cat, data);
  renderAges(el.age10, el.age20, data);
  el.updateTime.textContent = new Date().toLocaleTimeString('fr-FR');
});

// Dark mode toggle
el.themeToggle.addEventListener('click', e => {
  e.preventDefault();
  document.body.classList.toggle('dark');
});
</script>
</body>
</html>
